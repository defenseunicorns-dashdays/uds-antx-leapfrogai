includes:
  - create: https://raw.githubusercontent.com/defenseunicorns/uds-common/v0.9.0/tasks/create.yaml
  - lint: https://raw.githubusercontent.com/defenseunicorns/uds-common/v0.9.0/tasks/lint.yaml
  - pull: https://raw.githubusercontent.com/defenseunicorns/uds-common/v0.9.0/tasks/pull.yaml
  - deploy: https://raw.githubusercontent.com/defenseunicorns/uds-common/v0.9.0/tasks/deploy.yaml
  - setup: https://raw.githubusercontent.com/defenseunicorns/uds-common/v0.9.0/tasks/setup.yaml

tasks:
  - name: cluster-up
    description: Build and deploy SWF on UDS k3d-slim-dev
    actions:
      - task: setup:k3d-test-cluster

  - name: deploy-bundle
    description: Deploy ANTX UDS Bundle
    actions:
      - task: deploy:test-bundle

  - name: destroy
    description: Destroy the K3d cluster
    actions:
      - cmd: k3d cluster delete -a

  - name: create-bundle
    description: Create the ANTX UDS Bundle
    actions:
      - task: package
      - task: create:test-bundle
        with:
          path: bundle
          options: -o build

  - name: package
    description: Package(zarf) the ANTX Application
    actions:
      - cmd: mkdir -p build
      - task: package-ui

  - name: clean
    description: take out the trash
    actions:
      - cmd: rm -rf build

  ### UI Tasks ###
  - name: build-ui-image
    description: Build the UI image
    actions:
      - cmd: docker build -t ghcr.io/defenseunicorns-dashdays/uds-antx-leapfrogai/ui:0.0.1 .
        dir: src/ui

  - name: package-ui
    description: Package(zarf) the UI image
    actions:
      - task: build-ui-image
      - task: create:package
        with:
          path: src/ui
          options: -o build